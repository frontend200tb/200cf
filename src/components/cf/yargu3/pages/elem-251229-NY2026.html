<article class="article">
  <strong>Спортивное программирование в ЯрГУ</strong>
  <p><a href="https://codeforces.com/group/CkAC2YcRrZ/contests" target="_blank">ЯрГУ. Кружок. Контесты</a></p>
  <p>Автор кружка Игорь Маслеников</p>
</article>


<article class="article">
  <h1>Новогодний контест 2026</h1>
  <p><a href="https://codeforces.com/group/CkAC2YcRrZ/contest/661028" target="_blank">Codeforces Контест 661028 2025-12-29</a></p>
</article>


<!-- Содержание -->
<article class="article">
  <h2>Содержание</h2>

      <a href="#task1">Задача A1. Новый год и спешка</a>
  <br><a href="#task2">Задача A2. Новый год и дни</a>
  <br><a href="#task3">Задача A3. Новогодние свечки</a>
  <br><a href="#task4">Задача B1. Новый год и северный полюс</a>
  <br><a href="#task5">Задача B2. Новый год и старые свойства</a>
  <br><a href="#task6">Задача B3. Новогодний подарок</a>
  <br><a href="#task7">Задача C1. Новый год и рейтинг</a>
  <br><a href="#task8">Задача C2. Новый год и домино</a>
  <br><a href="#task9">Задача C3. Новогоднее изменение рейтинга</a>
  <br><a href="#task10">Задача D1. Новый год и фейерверки</a>
  <br><a href="#task11">Задача D2. Новый год и древнее пророчество</a>
  <br><a href="#task12">Задача D3. Новогоднее письмо</a>
</article>


<!-- Задача A1. Новый год и спешка -->
<article class="article">
  <div class="anchor" id="task1"></div>
  <h3>Задача A1. Новый год и спешка</h3>

  <div class="time-memory">(Время 1с. Память 256мб)</div>

  <p>В последний день уходящего 2016 года Лимак собирается принять участие в соревновании по спортивному программированию. Соревнование начнётся в 20:00 и будет продолжаться четыре часа, то есть ровно до полуночи. Участникам будет предложено n задач, упорядоченных по возрастанию сложности, то есть задача 1 будет самой лёгкой, а задача номер n — самой сложной. Лимак знает, что ему потребуется 5·i минут на решение i-й задачи.</p>

  <p>Друзья Лимака планирую устроить роскошную новогоднюю вечеринку и Лимак хочет прибыть в полночь или ранее. Он знает, что ему требуется ровно k минут чтобы добрать до места проведения вечеринки от своего дома, где он собирается участвовать в соревновании.</p>

  <p>Сколько максимум задач может успеть решить Лимак, так чтобы не опоздать на новогоднюю вечеринку?</p>

  <h4>Входные данные</h4>
  <p>В первой строке входных данных записаны два целых числа n и k (1 ≤ n ≤ 10, 1 ≤ k ≤ 240) — количество задач в соревновании и количество минут, за которое Лимак доберётся от дома до места проведения вечеринки.</p>

  <h4>Выходные данные</h4>
  <p>Выведите одно целое число, равное максимальному количеству задач, которое может решить Лимак, так чтобы прибыть на новогоднюю вечеринку ровно в полночь или раньше.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
    <code>3 222</code>
    <code>2</code>

    <h4>Пример 2</h4>
    <code>4 190</code>
    <code>4</code>

    <h4>Пример 3</h4>
    <code>7 1</code>
    <code>7</code>
  </details>

  <p>В первом примере на соревновании участникам предложено 3 задачи и Лимаку требуется 222 минуты, чтобы доехать до места проведения вечеринки. Для решения задач требуется 5, 10 и 15 минут соответственно. Лимак может решить первые две задачи, потравив на это 5 + 10 = 15 минут, после чего выехать в 20:15 и приехать на вечеринку в 23:57 (через 222 минуты). Таким образом он решит две задачи, но на решение третьей времени уже не хватит и ответ равен 2.</p>

  <p>Во втором примере Лимак может решить все 4 задачи за 5 + 10 + 15 + 20 = 50 минут. В 20:50 он сможет выехать из дома и прибыть на вечеринку ровно в полночь.</p>

  <p>В третьем примере Лимаку нужна только 1 минута, чтобы оказаться на вечеринке, так что ему хватит времени для решения всех 7 задач.</p>
</article>


<!-- Задача A2. Новый год и дни -->
<article class="article">
  <div class="anchor" id="task2"></div>
  <h3>Задача A2. Новый год и дни</h3>

  <div class="time-memory">(Время 2с. Память 256мб)</div>

  <p>Сегодня среда, третий день недели, но гораздо интереснее то, что завтра последний день 2015-го года.</p>

  <p>Лимак — белый медвежонок, которому очень понравился этот год, и он с нетерпением ждёт грядущего 2016 года. Лимак хочет показать всем, какой он ответственный медвежонок, поэтому он собирается копить конфеты на протяжении всего 2016-го года! С этой целью он рассматривает два различных плана: откладывать одну конфету в какой-то фиксированный день недели, либо в какой-то фиксированный день месяца.</p>

  <p>Лимак выбрал конкретный план и просит вас посчитать, сколько конфет он накопит в 2016 году, если будет строго придерживаться выбранного плана. Пожалуйста, посчитайте это значение и скажите ему.</p>

  <h4>Входные данные</h4>
  <p>Единственная строка входных данных следует одному из двух форматов:</p>
  <ul>
    <li>"x of week", где x (1 ≤ x ≤ 7) обозначает день недели.</li>
    <li>"x of month", где x (1 ≤ x ≤ 31) обозначает день месяца.</li>
  </ul>

  <h4>Выходные данные</h4>
  <p>Выведите единственное целое число — количество конфет, которые Лимак накопит в 2016 году.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
    <code>4 of week</code>
    <code>52</code>

    <h4>Пример 2</h4>
    <code>30 of month</code>
    <code>11</code>
  </details>

  <p>Белые медведи живут по Григорианскому календарю. Это наиболее распространённый календарь, и, скорее всего, вы тоже его используете. Если вам требуются уточнения, то можете прочитать соответствующую статью на Википедии – https://ru.wikipedia.org/wiki/Григорианский_календарь.</p>

  <p>В первом примере Лимак будет откладывать по конфете каждый четверг (4-й день недели). В 2016 году 52 четверга, следовательно медвежонок накопит 52 конфеты.</p>

  <p>Во втором примере Лимак будет откладывать по одной конфете в 30-й день каждого месяца. 30-й день есть ровно в 11 месяцах 2016 года — всех, кроме февраля. Таким образом, Лимак накопит 11 конфет.</p>
</article>


<!-- Задача A3. Новогодние свечки -->
<article class="article">
  <div class="anchor" id="task3"></div>
  <h3>Задача A3. Новогодние свечки</h3>

  <div class="time-memory">(Время 1с. Память 256мб)</div>

  <p>Программист Василий любит романтику — поэтому на этот Новый Год он решил освещать свою комнату свечами.</p>

  <p>У Василия есть a свечей. Когда Василий зажигает новую свечу, сначала она горит ровно один час, а затем тухнет. Василий — сообразительный малый, поэтому из b потухших свечей он умеет получать одну новую свечу. В последствии эту новую свечу (так же как и другие новые свечи) можно зажечь.</p>

  <p>Теперь Василию интересно, на сколько часов освещения хватит его свечек, если он будет действовать оптимальным образом. Помогите ему найти это число.</p>

  <h4>Входные данные</h4>
  <p>В единственной строке заданы два целых числа a и b (1 ≤ a ≤ 1000; 2 ≤ b ≤ 1000).</p>

  <h4>Выходные данные</h4>
  <p>Выведите единственное целое число — количество часов, которое Василий сможет освещать комнату.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
    <code>4 2</code>
    <code>7</code>

    <h4>Пример 2</h4>
    <code>6 3</code>
    <code>8</code>
  </details>

  <p>Рассмотрим первый тестовый пример. Первые четыре часа Василий будет зажигать свечи, которые изначально были новые, дальше из четырех потухших свечей он сделает две новые, которые в последствии зажжет. Когда эти две свечи прогорят (станут потухшими), можно будет из них сделать еще одну свечу. Итого, Василий сможет освещать комнату 7 часов.</p>
</article>


<!-- Задача B1. Новый год и северный полюс -->
<article class="article">
  <div class="anchor" id="task4"></div>
  <h3>Задача B1. Новый год и северный полюс</h3>

  <div class="time-memory">(Время 2с. Память 256мб)</div>

  <p>В данной задаче мы будем полагать, что планета Земля является идеальным шаром, а её поверхность — идеальной сферой. Длину экватора и любого меридиана будем считать равной в точности 40 000 километров. Таким образом, путешествие от Северного полюса к Южному полюсу или наоборот занимает 20 000 километров.</p>

  <p>Полярный медвежонок Лимак живёт на Северном полюсе. Незадолго до нового года он помогает кое-кому развозить подарки по всему миру. К сожалению, вместо точных координат мест, которые Лимак должен посетить, ему выдали лишь описание маршрута движения, в предположении, что он начинает на Северном полюсе. Описание маршрута состоит из n частей. На i-м участке Лимак должен двигаться ti километров в направлении, определяемом строкой diri, которая является одной из строк «North», «South», «West», «East». Данные направления означают движение на север, юг, запад и восток соответственно.</p>

  <p>Лимак не уверен, что описание маршрута корректно. Помогите ему проверить выполнение следующих условий:</p>
  <ul>
    <li>Если в некоторый момент времени (перед выполнением какой-либо инструкции или во время выполнения одной из них) Лимак находится на Северном полюсе, то он может двигаться только на юг.</li>
    <li>Если в некоторый момент времени (перед выполнением какой-либо инструкции или во время выполнения одной из них) Лимак находится на Южном полюсе, то он может двигаться только на север.</li>
    <li>Путешествие обязательно должно завершаться на Северном полюсе.</li>
  </ul>

  <p>Проверьте, что все три условия выше выполняются и выведите «YES» или «NO».</p>

  <h4>Входные данные</h4>
  <p>В первой строке входных данных записано целое число n (1 ≤ n ≤ 50).</p>

  <p>В i-й из последующих n строк записано целое число ti и строка diri (1 ≤ ti ≤ 10⁶, ) — длина i-го участка маршрута и направление, в котором должен двигаться Лимак.</p>

  <h4>Выходные данные</h4>
  <p>Выведите «YES», если данный маршрут удовлетворяет всем трём условиям. В противном случае выведите «NO».</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
<pre>
5
7500 South
10000 East
3500 North
4444 West
4000 North
</pre>
    <code>YES</code>

    <h4>Пример 2</h4>
<pre>
2
15000 South
4000 East
</pre>
    <code>NO</code>

    <h4>Пример 3</h4>
<pre>
5
20000 South
1000 North
1000000 West
9000 North
10000 North
</pre>
    <code>YES</code>

    <h4>Пример 4</h4>
<pre>
3
20000 South
10 East
20000 North
</pre>
    <code>NO</code>

    <h4>Пример 5</h4>
<pre>
2
1000 North
1000 South
</pre>
    <code>NO</code>

    <h4>Пример 6</h4>
<pre>
4
50 South
50 North
15000 South
15000 North
</pre>
    <code>YES</code>
  </details>
  <p>Рисунок ниже демонстрирует как будет выглядеть путешествие Лимака в первых двух примерах. Во втором примере ответ «NO», поскольку путешествие не заканчивается на Северном полюсе.</p>
</article>


<!-- Задача B2. Новый год и старые свойства -->
<article class="article">
  <div class="anchor" id="task5"></div>
  <h3>Задача B2. Новый год и старые свойства</h3>

  <div class="time-memory">(Время 2с. Память 256мб)</div>

  <p>2015 год почти подошёл к концу.</p>

  <p>Лимак — белый медвежонок, который недавно узнал о двоичной системе счисления. Он сразу заметил, что запись номера прошедшего года в двоичной системе счисления содержит ровно один ноль — 2015₁₀ = 11111011111₂. Обратите внимание, количество нулей в записи числа в десятичной системе счисления значения не имеет.</p>

  <p>Лимак выбрал некоторый интервал лет и теперь собирается посчитать количество лет из этого интервала, таких что их запись в двоичной системе счисления так же содержит ровно один ноль. А сможете ли вы сделать это быстрее?</p>

  <p>Считайте, что положительные целые числа всегда записываются без ведущих нулей.</p>

  <h4>Входные данные</h4>
  <p>В единственной строке входных данных записаны два целых числа a и b (1 ≤ a ≤ b ≤ 10¹⁸) — первый и последний год в интервале Лимака, соответственно.</p>

  <h4>Выходные данные</h4>
  <p>Выведите одно целое число — количество лет в данном интервале, запись которых в двоичной системе счисления содержит ровно один ноль.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
    <code>5 10</code>
    <code>2</code>

    <h4>Пример 2</h4>
    <code>2015 2015</code>
    <code>1</code>

    <h4>Пример 3</h4>
    <code>100 105</code>
    <code>0</code>

    <h4>Пример 4</h4>
    <code>72057594000000000 72057595000000000</code>
    <code>26</code>
  </details>
  <p>В первом примере интервал Лимака содержит числа 5₁₀ = 101₂, 6₁ = 110₂, 7₁₀ = 111₂, 8₁₀ = 1000₂, 9₁₀ = 1001₂ и 10₁₀ = 1010₂. Два из них (101₂ и 110₂) обладают описанным выше свойством.</p>
</article>


<!-- Задача B3. Новогодний подарок -->
<article class="article">
  <div class="anchor" id="task6"></div>
  <h3>Задача B3. Новогодний подарок</h3>

  <div class="time-memory">(Время 1с. Память 256мб)</div>

  <p>Совсем скоро начнется новый год. По этой причине большинство людей сегодня заняты подготовкой новогодних подарков. Программист Василий — не исключение.</p>

  <p>Василий знает, что лучший подарок — это (нет, не контест) деньги. Он уже выложил в ряд слева направо n пустых кошельков и решил, сколько монеток в какой кошелек положить. В i-ый слева кошелек Василий решил положить ai монет.</p>

  <p>Василий — человек очень занятой, поэтому монеты по кошелькам будет раскладывать его робот. Изначально робот стоит около самого левого кошелька в ряду. Робот умеет выполнять команды трех видов: перейти к кошельку, который находится слева от текущего (если такой имеется), перейти к кошельку, который находится справа от текущего (если такой имеется), положить монетку в текущий кошелек. В силу некоторых технических неполадок робот не может выполнить две команды вида «положить монетку» подряд.</p>

  <p>Василий не может долго ждать, поэтому он хочет написать программу для робота, состоящую из не более 10⁶ операций (не обязательно минимальную по длине), с помощью которой робот разложит монетки по кошелькам. Помогите ему.</p>

  <h4>Входные данные</h4>
  <p>В первой строке записано целое число n (2 ≤ n ≤ 300) — количество кошельков. В следующей строке записаны n целых чисел a1, a2, ..., an (0 ≤ ai ≤ 300).</p>

  <p>Гарантируется, что хотя бы одно ai положительное.</p>

  <h4>Выходные данные</h4>
  <p>Выведите последовательность, состоящую из k (1 ≤ k ≤ 10⁶) символов, каждый из которых равен: «L», «R» или «P». Каждый символ последовательности — это команда роботу. Символ «L» — команда перейти влево, символ «R» — команда перейти вправо, символ «P» — команда положить монетку. Не разрешается выходить за пределы последовательности кошельков. Другими словами, нельзя выполнять команду «L», стоя около кошелька 1, и нельзя выполнять команду «R», стоя около кошелька n.</p>

  <p>В результате проделанных операций в i-ом слева кошельке должно лежать ровно ai монет. Если существует несколько ответов, разрешается вывести любой.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
<pre>
2
1 2
</pre>
    <code>PRPLRP</code>

    <h4>Пример 2</h4>
<pre>
4
0 2 0 2
</pre>
    <code>RPRRPLLPLRRRP</code>
  </details>
</article>


<!-- Задача C1. Новый год и рейтинг -->
<article class="article">
  <div class="anchor" id="task7"></div>
  <h3>Задача C1. Новый год и рейтинг</h3>

  <div class="time-memory">(Время 2с. Память 256мб)</div>

  <p>У каждого пользователя Codeforces есть рейтинг, который описывается одним целым числом, возможно отрицательным или нулём. Все пользователи разделены на два дивизиона. К первому дивизиону относятся пользователи с рейтингом 1900 и выше. Пользователи с рейтингом 1899 и меньше относятся ко второму дивизиону. После каждого соревнования, в зависимости от показанного результата рейтинг пользователя изменяется на некоторое целое число, возможно отрицательное или ноль.</p>

  <p>В 2016 году Лимак принял участие в n соревнованиях. Он помнит, что во время соревнования i он был дивизионе di (то есть он принадлежал данному дивизиону непосредственно перед началом данного соревнования) и после соревнования его рейтинг изменился на величину ci. Обратите внимание, отрицательные значения ci означают, что рейтинг уменьшился.</p>

  <p>Какой максимальный рейтинг может быть у Лимака после всех n соревнований? Если его рейтинг может быть сколь угодно большим, то выведите «Infinity». Если информация является противоречивой и не может быть верной ни для какого значения рейтинга, выведите «Impossible».</p>

  <h4>Входные данные</h4>
  <p>В первой строке входных данных записано целое число n (1 ≤ n ≤ 200 000).</p>

  <p>В i-й из последующих n строк записаны два целых числа ci и di ( - 100 ≤ ci ≤ 100, 1 ≤ di ≤ 2), описывающих изменение рейтинга после соревнования и дивизион Лимака во время i-го соревнования.</p>

  <h4>Выходные данные</h4>
  <p>Если текущий рейтинг Лимака может быть сколь угодно большим, то выведите «Infinity» (без кавычек). Если информация из входных данных является невозможной, то выведите «Impossible» (без кавычек). В противном случае выведите максимально возможный рейтинг Лимака после всех n соревнований.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
<pre>
3
-7 1
5 2
8 2
</pre>
    <code>1907</code>

    <h4>Пример 2</h4>
<pre>
2
57 1
22 2
</pre>
    <code>Impossible</code>

    <h4>Пример 3</h4>
<pre>
1
-5 1
</pre>
    <code>Infinity</code>

    <h4>Пример 4</h4>
<pre>
4
27 2
13 1
-50 1
8 2
</pre>
    <code>1897</code>
  </details>

  <p>В первом примере следующий сценарий соответствует всей информации из входных данных и максимально возможному итоговому рейтингу:</p>
  <ol>
    <li>Рейтинг Лимака изначально равен 1901 и он находится в дивизионе 1. После первого контеста рейтинг Лимака понижается на 7.</li>
    <li>С рейтингом 1894 Лимак соревнуется в дивизионе 2. Его рейтинг увеличивается на 5.</li>
    <li>Рейтинг Лимака равен 1899 и он всё ещё в дивизионе 2. В последнем контесте года изменение его рейтинга равняется + 8 и он завершает год с рейтингом 1907.</li>
  </ol>

  <p>Во втором примере, ситуация что Лимак соревновался в дивизионе 1, а после увеличения рейтинга на 57 оказался в дивизионе 2, является невозможной.</p>
</article>


<!-- Задача C2. Новый год и домино -->
<article class="article">
  <div class="anchor" id="task8"></div>
  <h3>Задача C2. Новый год и домино</h3>

  <div class="time-memory">(Время 3с. Память 256мб)</div>

  <p>Лимак — белый медвежонок, который очень любит играть. Недавно он получил прямоугольную таблицу, состоящую из h рядов и w столбцов. Каждая клетка этой таблицы либо пустая (обозначается '.'), либо занятая (обозначается '#'). Ряды нумеруются от 1 до h сверху вниз. Столбцы нумеруются от 1 до w слева направо.</p>

  <p>Также у Лимака есть одна доминошка, которую он хочет поместить куда-нибудь в табличку. Доминошка займёт две соседние по стороне клетки, расположенные в одной строке или в одном столбце. Обе эти клетки должны быть пустыми и находиться внутри таблицы.</p>

  <p>Лимаку нужно больше играть и веселиться, поэтому он рассмотрит некоторые запросы. В каждом запросе он выбирает некоторый прямоугольник и задаётся вопросом: а сколькими способами можно полностью поместить имеющуюся доминошку в выбранный прямоугольник?</p>

  <h4>Входные данные</h4>
  <p>В первой строке записаны два целых числа h и w (1 ≤ h, w ≤ 500) — количество строк и количество столбцов в таблице, соответственно.</p>

  <p>В следующих h строках записана таблица. В каждой строке находится строка длины w, каждый символ которой равен либо '.', либо '#', что означает пустую и занятую клетку, соответственно.</p>

  <p>В следующей строке записано единственное число q (1 ≤ q ≤ 100 000) — количество запросов.</p>

  <p>В каждой из следующих q строк находятся по четыре целых числа r1i, c1i, r2i, c2i (1 ≤ r1i ≤ r2i ≤ h, 1 ≤ c1i ≤ c2i ≤ w) — i-й запрос. Числа r1i и c1i определяет верхний левый угол, а числа r2i и c2i — нижний правый угол соответствующего прямоугольника.</p>

  <h4>Выходные данные</h4>
  <p>Выведите q чисел, i-е из которых соответствует количеству способов полностью расположить доминошку внутри i-го прямоугольника.</p>


  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
<pre>
5 8
....#..#
.#......
##.#....
##..#.##
........
4
1 1 2 3
4 1 4 1
1 2 4 5
2 5 5 8
</pre>
<pre>
4
0
10
15
</pre>

    <h4>Пример 2</h4>
<pre>
7 39
.......................................
.###..###..#..###.....###..###..#..###.
...#..#.#..#..#.........#..#.#..#..#...
.###..#.#..#..###.....###..#.#..#..###.
.#....#.#..#....#.....#....#.#..#..#.#.
.###..###..#..###.....###..###..#..###.
.......................................
6
1 1 3 20
2 10 6 30
2 10 7 30
2 2 7 7
1 7 7 7
1 8 7 8
</pre>
<pre>
53
89
120
23
0
2
</pre>
  </details>
  <p>Красная рамочка на рисунке ниже соответствует первому запросу в первом примере. Существует 4 способа расположить доминошку.</p>
</article>


<!-- Задача C3. Новогоднее изменение рейтинга -->
<article class="article">
  <div class="anchor" id="task9"></div>
  <h3>Задача C3. Новогоднее изменение рейтинга</h3>

  <div class="time-memory">(Время 1с. Память 256мб)</div>

  <p>На одном очень известном интернет ресурсе (будем называть его X) задумали новогоднюю авантюру. А именно, решили подарить всем посетителям рейтинга.</p>

  <p>Ресурс X посещают n пользователей, и для каждого пользователя известно, сколько рейтинга он хочет получить в подарок на новый год. Известно, что пользователь i хочет получить не менее ai рейтинга в подарок.</p>

  <p>Администраторы ресурса X — люди очень креативные и экономные. Поэтому с одной стороны, они хотят, чтобы все полученные рейтинги были различны, а с другой — чтобы суммарное количество подаренного рейтинга было как можно меньше.</p>

  <p>Помогите ресурсу X справиться со сложной задачей распределения рейтинга. Найдите оптимальное распределение.</p>

  <h4>Входные данные</h4>
  <p>В первой строке записано целое число n (1 ≤ n ≤ 3·10⁵) — количество пользователей ресурса. В следующей строке записана последовательность целых чисел a1, a2, ..., an (1 ≤ ai ≤ 10⁹).</p>

  <h4>Выходные данные</h4>
  <p>Выведите последовательность целых чисел b1, b2, ..., bn. Число bi обозначает, что пользователь i получит bi рейтинга в подарок. Выведенная последовательность должна удовлетворять условиям задачи.</p>

  <p>Если существует несколько оптимальных решений, разрешается вывести любое.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
<pre>
3
5 1 1
</pre>
    <code>5 1 2</code>

    <h4>Пример 2</h4>
<pre>
1
1000000000
</pre>
    <code>1000000000</code>
  </details>
</article>


<!-- Задача D1. Новый год и фейерверки -->
<article class="article">
  <div class="anchor" id="task10"></div>
  <h3>Задача D1. Новый год и фейерверки</h3>

  <div class="time-memory">(Время 2.5с. Память 256мб)</div>

  <p>Одной из популярных традиций встречи нового года является запуск в небо фейерверков. Обычно фейерверк взлетает вертикально вверх в течение некоторого времени, после чего взрывается и разделяется на несколько частей, летящих в разных направлениях. Иногда эти части через некоторое время снова взрываются, также разделяясь на несколько частей и так далее.</p>

  <p>Лимак живёт на бесконечном клетчатом поле и у него есть один фейерверк. Поведение этого фейерверка после запуска описывается рекурсией глубины n и продолжительностью каждого из уровней рекурсии t1, t2, ..., tn. Как только Лимак запустит фейерверк в какой-нибудь клетке поля, тот начнёт двигаться вверх. После прохождения t1 клеток (включая стартовую) он взрывается и разделяется на две части, каждая из которых двигается в направлении, изменённом на 45 градусов (для лучшего понимания посмотрите картинки ниже). Таким образом, одна часть будет двигаться в направлении вверх и влево, а другая в направлении вверх и вправо. Каждая из этих частей пройдёт t2 клеток, после чего также разделится на две части, каждая из которых также изменит траекторию на 45 градусов. Процесс будет продолжаться до n-го уровня рекурсии, после чего все 2<sup>n - 1</sup> частей взорвутся и исчезнут не создавая новых частей.</p>

  <p>После нескольких уровней рекурсивного разделения частей фейерверка может так оказаться, что две или более частей находятся в одной и той же клетке в один и тот же момент времени — такая ситуация разрешена и эти части не сталкиваются.</p>

  <p>Перед тем как запустить данный фейерверк Лимак хочет убедиться в безопасности этого запуска. Сможете ли вы посчитать количество клеток, которые хотя бы один раз будут посещены какой-либо частью фейерверка?</p>

  <h4>Входные данные</h4>
  <p>В первой строке входных данных записано целое число n (1 ≤ n ≤ 30) — глубина рекурсии разделения фейерверка на части.</p>

  <p>Во второй строке записаны n целых чисел t1, t2, ..., tn (1 ≤ ti ≤ 5). На i-м уровне каждая из 2<sup>i - 1</sup> частей фейерверка пройдёт ti клеток перед тем как взорвётся.</p>

  <h4>Выходные данные</h4>
  <p>Выведите одно целое число, равное количеству клеток которые будут посещены хотя бы одной частью фейерверка хотя бы один раз.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
<pre>
4
4 2 2 3
</pre>
    <code>39</code>

    <h4>Пример 2</h4>
<pre>
6
1 1 1 1 1 3
</pre>
    <code>85</code>

    <h4>Пример 3</h4>
<pre>
1
3
</pre>
    <code>3</code>
  </details>

  <p>Рассмотрим первый пример. Рисунки ниже показывают как будет выглядеть процесс работы фейерверка после каждого уровня рекурсии. Лимак запускает фейерверк из самой нижней красной клетки. После прохождения t1 = 4 клеток (отмеченных красным) он взрывается и делится на две части (их дальнейшее движение показано зелёным). Все взрывы отмечены символом «X». На последнем рисунке присутствуют 4 красных, 4 зелёных, 8 оранжевых и 23 розовых клетки. Таким образом, итоговое количество посещённых клеток равняется 4 + 4 + 8 + 23 = 39.</p>
  <p>Для второго примера рисунки демонстрируют ситуацию на 4, 5 и 6 уровнях рекурсии. На рисунке посередине показаны направления всех частей, которые будут двигаться на следующем уровне.</p>
</article>


<!-- Задача D2. Новый год и древнее пророчество -->
<article class="article">
  <div class="anchor" id="task11"></div>
  <h3>Задача D2. Новый год и древнее пророчество</h3>

  <div class="time-memory">(Время 2.5с. Память 512мб)</div>

  <p>Маленький полярный медвежонок Лимак нашёл в снегу свитки с древним пророчеством. Никаких древних языков он не знает, поэтому в пророчестве ему не разобраться, зато он знает цифры!</p>

  <p>Один из фрагментов пророчества содержит последовательность из n цифр, причём первая из них не является нулём. Лимак полагает, что это последовательность каких-то годов. Пробелов и точек в записи нет, так что, возможно, древние люди их не использовали. Теперь Лимаку стало любопытно, какие же именно года фигурируют в фрагменте.</p>

  <p>Медвежонок сделал следующие три предположения:</p>
  <ul>
    <li>Года записаны в порядке строгого возрастания;</li>
    <li>Каждый год обозначается целым положительным числом;</li>
    <li>Ведущие нули не используются.</li>
  </ul>

  <p>Лимак хочет рассмотреть все возможные способы разбить данную последовательность цифр на числа (года), удовлетворяющие данным условиям. Он справится сам, без чьей либо помощи, однако попросил вас посчитать количество подходящих разбиений. Поскольку это число может быть достаточно большим, выведите его по модулю 10⁹ + 7.</p>

  <h4>Входные данные</h4>
  <p>Первая строка входных данных содержит единственное число n (1 ≤ n ≤ 5000) — количество цифр в фрагменте пророчества.</p>

  <p>Во второй строке записана строка длины n, состоящая только из цифр. Гарантируется, что первая цифра всегда не '0'.</p>

  <h4>Выходные данные</h4>
  <p>Выведите количество способов корректно разбить последовательность цифр на числа по модулю 10⁹ + 7.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
<pre>
6
123434
</pre>
    <code>8</code>

    <h4>Пример 2</h4>
<pre>
8
20152016
</pre>
    <code>4</code>
  </details>

  <p>В первом примере существует 8 способов разбить исходную последовательность:</p>
  <ul>
    <li>"123434" = "123434" (вся последовательность вполне может оказаться одним числом)</li>
    <li>"123434" = "1" + "23434"</li>
    <li>"123434" = "12" + "3434"</li>
    <li>"123434" = "123" + "434"</li>
    <li>"123434" = "1" + "23" + "434"</li>
    <li>"123434" = "1" + "2" + "3434"</li>
    <li>"123434" = "1" + "2" + "3" + "434"</li>
    <li>"123434" = "1" + "2" + "3" + "4" + "34"</li>
  </ul>

  <p>Обратите внимание, что нельзя выполнить разбиение "123434" = "12" + "34" + "34", поскольку последовательность должна быть строго возрастающей.</p>

  <p>Во втором примере существует 4 способа:</p>
  <ul>
    <li>"20152016" = "20152016"</li>
    <li>"20152016" = "20" + "152016"</li>
    <li>"20152016" = "201" + "52016"</li>
    <li>"20152016" = "2015" + "2016"</li>
  </ul>
</article>


<!-- Задача D3. Новогоднее письмо -->
<article class="article">
  <div class="anchor" id="task12"></div>
  <h3>Задача D3. Новогоднее письмо</h3>

  <div class="time-memory">(Время 1с. Память 512мб)</div>

  <p>Во многих странах есть новогодняя традиция — писать письма дедушке Морозу со своими пожеланиями подарков на новый год. Вася — обыкновенный мальчик-программист. Как все обыкновенные мальчики, он в канун нового года собирается написать письмо дедушке Морозу.</p>

  <p>Вася уже придумал алгоритм, по которому он будет писать письмо. Сначала он выберет две строки s1 и s2, состоящие из прописных латинских букв. Далее мальчик составит строку sk, пользуясь рекуррентным соотношением sn = sn - 2 + sn - 1, операция '+' обозначает конкатенацию (то есть последовательную запись) строк в заданном порядке. После чего Вася запишет строку sk на листочек, положит его в письмо и пошлет письмо деду Морозу.</p>

  <p>Вася точно уверен: чтобы дед Мороз подарил ему самый лучший подарок, нужно чтобы в полученной строке sk подстрока AC встречалась ровно x раз (сокращение AC напоминает Васе о сданных задачах). Более того, Вася решил, что строка s1 должна иметь длину n, а строка s2 — длину m. Больше Вася ничего не решил.</p>

  <p>У Васи сейчас срочные новогодние дела, поэтому он просит вас выбрать для него две строки s1 и s2 требуемым образом. Помогите Васе.</p>

  <h4>Входные данные</h4>
  <p>В первой строке записано четыре целых числа k, x, n, m (3 ≤ k ≤ 50; 0 ≤ x ≤ 109; 1 ≤ n, m ≤ 100).</p>

  <h4>Выходные данные</h4>
  <p>В первой строке выведите строку s1, состоящую из n заглавных латинских букв. Во второй строке выведите строку s2, состоящую из m заглавных латинских букв. Если существует несколько подходящих строк, разрешается вывести любую.</p>

  <p>Если требуемой пары строк не существует, выведите «Happy new year!» без кавычек.</p>

  <details>
    <summary>Примеры</summary>
    <h4>Пример 1</h4>
    <code>3 2 2 2</code>
<pre>
AC
AC
</pre>

    <h4>Пример 2</h4>
    <code>3 3 2 2</code>
    <code>Happy new year!</code>

    <h4>Пример 3</h4>
    <code>3 0 2 2</code>
<pre>
AA
AA
</pre>

    <h4>Пример 4</h4>
    <code>4 3 2 1</code>
    <code>Happy new year!</code>

    <h4>Пример 5</h4>
    <code>4 2 2 1</code>
    <code>Happy new year!</code>
  </details>
</article>

